<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=en_in" />
<title>
  Module: Bio::NeXML::Mapper::Framework
  
    &mdash; Documentation by YARD 0.7.2
  
</title>

  <link rel="stylesheet" href="../../../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '../../..';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../../../_index.html">Index (F)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../../../Bio.html" title="Bio (module)">Bio</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../NeXML.html" title="Bio::NeXML (module)">NeXML</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Mapper.html" title="Bio::NeXML::Mapper (module)">Mapper</a></span></span>
     &raquo; 
    <span class="title">Framework</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Module: Bio::NeXML::Mapper::Framework
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">lib/bio/db/nexml/mapper/framework.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>
Framework is the real workhorse of Mapper.
</p>


  </div>
</div>
<div class="tags">
  
</div>




  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#belongs_to-instance_method" title="#belongs_to (instance method)">- (Object) <strong>belongs_to</strong>(name, options = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Define a source for the target.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#has_n-instance_method" title="#has_n (instance method)">- (Object) <strong>has_n</strong>(target, options = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Define target set for the source.
</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="belongs_to-instance_method">
  
    - (<tt>Object</tt>) <strong>belongs_to</strong>(name, options = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Define a source for the target.
</p>
<pre class="code">
   <span class='belongs_to identifier id'>belongs_to</span> <span class='symbol val'>:source</span>
</pre>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bio/db/nexml/mapper/framework.rb', line 10</span>

<span class='def def kw'>def</span> <span class='belongs_to identifier id'>belongs_to</span><span class='lparen token'>(</span> <span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span> <span class='rparen token'>)</span>
  <span class='update identifier id'>update</span> <span class='assign token'>=</span> <span class='lparen token'>(</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span> <span class='symbol val'>:update</span> <span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='name identifier id'>name</span><span class='dot token'>.</span><span class='key identifier id'>key</span> <span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_sym identifier id'>to_sym</span>

  <span class='comment val'># create attribute reader for source</span>
  <span class='attr_reader identifier id'>attr_reader</span> <span class='name identifier id'>name</span>

  <span class='comment val'># Add this target to a source.</span>
  <span class='comment val'>#    def add_to_source( source )</span>
  <span class='comment val'>#      return if @source == source or source.nil?</span>
  <span class='comment val'>#      @source = source</span>
  <span class='comment val'>#      source.add_target( self )</span>
  <span class='comment val'>#    end</span>
  <span class='define_method identifier id'>define_method</span><span class='lparen token'>(</span> <span class='dstring node'>&quot;add_to_#{name}&quot;</span> <span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='source identifier id'>source</span><span class='comma token'>,</span><span class='bitor op'>|</span>
    <span class='comment val'># return if the target already belongs to</span>
    <span class='comment val'># the given source or if the source is nil.</span>
    <span class='return return kw'>return</span> <span class='if if_mod kw'>if</span> <span class='ivget identifier id'>ivget</span><span class='lparen token'>(</span> <span class='name identifier id'>name</span> <span class='rparen token'>)</span> <span class='eq op'>==</span> <span class='source identifier id'>source</span> <span class='or or kw'>or</span> <span class='source identifier id'>source</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>

    <span class='comment val'># add source and send a message to source</span>
    <span class='comment val'># to add self as target.</span>
    <span class='ivset identifier id'>ivset</span><span class='lparen token'>(</span> <span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='source identifier id'>source</span> <span class='rparen token'>)</span>
    <span class='source identifier id'>source</span><span class='dot token'>.</span><span class='send identifier id'>send</span><span class='lparen token'>(</span> <span class='dstring node'>&quot;add_#{update}&quot;</span><span class='comma token'>,</span> <span class='self self kw'>self</span> <span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Set or remove source.</span>
  <span class='comment val'>#    def source=( source )</span>
  <span class='comment val'>#      return remove_from_source if source.nil?</span>
  <span class='comment val'>#      return add_to_source( self )</span>
  <span class='comment val'>#    end</span>
  <span class='define_method identifier id'>define_method</span><span class='lparen token'>(</span> <span class='dstring node'>&quot;#{name}=&quot;</span> <span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='source identifier id'>source</span><span class='comma token'>,</span><span class='bitor op'>|</span>
    <span class='return return kw'>return</span> <span class='send identifier id'>send</span><span class='lparen token'>(</span> <span class='dstring node'>&quot;remove_from_#{name}&quot;</span> <span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='source identifier id'>source</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
    <span class='return return kw'>return</span> <span class='send identifier id'>send</span><span class='lparen token'>(</span> <span class='dstring node'>&quot;add_to_#{name}&quot;</span><span class='comma token'>,</span> <span class='source identifier id'>source</span> <span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Remove this target from an existing source.</span>
  <span class='comment val'>#    def remove_from_source</span>
  <span class='comment val'>#      return unless source = @source</span>
  <span class='comment val'>#      @source = nil</span>
  <span class='comment val'>#      source.delete_target( self )</span>
  <span class='comment val'>#    end</span>
  <span class='define_method identifier id'>define_method</span><span class='lparen token'>(</span> <span class='dstring node'>&quot;remove_from_#{name}&quot;</span> <span class='rparen token'>)</span> <span class='do do kw'>do</span>
    <span class='comment val'># return if a sourc is not set.</span>
    <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='source identifier id'>source</span> <span class='assign token'>=</span> <span class='ivget identifier id'>ivget</span><span class='lparen token'>(</span> <span class='name identifier id'>name</span> <span class='rparen token'>)</span>

    <span class='comment val'># remove source and send a message to source</span>
    <span class='comment val'># to remove itself as target.</span>
    <span class='ivset identifier id'>ivset</span><span class='lparen token'>(</span> <span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='nil nil kw'>nil</span> <span class='rparen token'>)</span>
    <span class='source identifier id'>source</span><span class='dot token'>.</span><span class='send identifier id'>send</span><span class='lparen token'>(</span> <span class='dstring node'>&quot;delete_#{update}&quot;</span><span class='comma token'>,</span> <span class='self self kw'>self</span> <span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="has_n-instance_method">
  
    - (<tt>Object</tt>) <strong>has_n</strong>(target, options = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Define target set for the source. has_n :otu
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bio/db/nexml/mapper/framework.rb', line 62</span>

<span class='def def kw'>def</span> <span class='has_n identifier id'>has_n</span><span class='lparen token'>(</span> <span class='target identifier id'>target</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span> <span class='rparen token'>)</span>
  <span class='name identifier id'>name</span> <span class='assign token'>=</span> <span class='lparen token'>(</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span> <span class='symbol val'>:singularize</span> <span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='false false kw'>false</span> <span class='rparen token'>)</span> <span class='question op'>?</span> <span class='target identifier id'>target</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span> <span class='colon op'>:</span> <span class='target identifier id'>target</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='dot token'>.</span><span class='singular identifier id'>singular</span>
  <span class='type identifier id'>type</span> <span class='assign token'>=</span> <span class='lparen token'>(</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span> <span class='symbol val'>:index</span> <span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='false false kw'>false</span> <span class='rparen token'>)</span> <span class='question op'>?</span> <span class='ArrayRepository constant id'>ArrayRepository</span> <span class='colon op'>:</span> <span class='HashRepository constant id'>HashRepository</span>
  <span class='update identifier id'>update</span> <span class='assign token'>=</span> <span class='lparen token'>(</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span> <span class='symbol val'>:update</span> <span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='name identifier id'>name</span><span class='dot token'>.</span><span class='key identifier id'>key</span> <span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_sym identifier id'>to_sym</span>

  <span class='comment val'># Return an Array of targets.</span>
  <span class='comment val'>#    def targets</span>
  <span class='comment val'>#      @targets.objects</span>
  <span class='comment val'>#    end</span>
  <span class='define_method identifier id'>define_method</span><span class='lparen token'>(</span> <span class='target identifier id'>target</span> <span class='rparen token'>)</span> <span class='do do kw'>do</span>
    <span class='repository identifier id'>repository</span><span class='lparen token'>(</span> <span class='target identifier id'>target</span><span class='comma token'>,</span> <span class='type identifier id'>type</span> <span class='rparen token'>)</span><span class='dot token'>.</span><span class='objects identifier id'>objects</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Set an Array as a target.</span>
  <span class='comment val'>#    def targets=( targets )</span>
  <span class='comment val'>#      @targets.clear</span>
  <span class='comment val'>#      targets.each do |t|</span>
  <span class='comment val'>#        add_target( t )</span>
  <span class='comment val'>#      end</span>
  <span class='comment val'>#    end</span>
  <span class='define_method identifier id'>define_method</span><span class='lparen token'>(</span> <span class='dstring node'>&quot;#{target}=&quot;</span> <span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='objects identifier id'>objects</span><span class='comma token'>,</span><span class='bitor op'>|</span>
    <span class='repository identifier id'>repository</span><span class='lparen token'>(</span> <span class='target identifier id'>target</span><span class='comma token'>,</span> <span class='type identifier id'>type</span> <span class='rparen token'>)</span><span class='dot token'>.</span><span class='clear identifier id'>clear</span>
    <span class='objects identifier id'>objects</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='o identifier id'>o</span><span class='bitor op'>|</span>                     
      <span class='send identifier id'>send</span><span class='lparen token'>(</span> <span class='dstring node'>&quot;add_#{name}&quot;</span><span class='comma token'>,</span> <span class='o identifier id'>o</span> <span class='rparen token'>)</span>  
    <span class='end end kw'>end</span>                        
  <span class='end end kw'>end</span>                         

  <span class='comment val'># Add a target.</span>
  <span class='comment val'>#    def add_target( target )</span>
  <span class='comment val'>#      return if @targets.include?( target )</span>
  <span class='comment val'>#      @targets.append( target )</span>
  <span class='comment val'>#      target.source = self</span>
  <span class='comment val'>#    end</span>
  <span class='define_method identifier id'>define_method</span><span class='lparen token'>(</span> <span class='dstring node'>&quot;add_#{name}&quot;</span> <span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='object identifier id'>object</span><span class='comma token'>,</span><span class='bitor op'>|</span>
    <span class='repository identifier id'>repository</span> <span class='assign token'>=</span> <span class='repository identifier id'>repository</span><span class='lparen token'>(</span> <span class='target identifier id'>target</span><span class='comma token'>,</span> <span class='type identifier id'>type</span> <span class='rparen token'>)</span>
    <span class='return return kw'>return</span> <span class='if if_mod kw'>if</span> <span class='repository identifier id'>repository</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span> <span class='object identifier id'>object</span> <span class='rparen token'>)</span>
    <span class='repository identifier id'>repository</span><span class='dot token'>.</span><span class='append identifier id'>append</span><span class='lparen token'>(</span> <span class='object identifier id'>object</span> <span class='rparen token'>)</span>
    <span class='object identifier id'>object</span><span class='dot token'>.</span><span class='send identifier id'>send</span><span class='lparen token'>(</span> <span class='dstring node'>&quot;#{update}=&quot;</span><span class='comma token'>,</span> <span class='self self kw'>self</span> <span class='rparen token'>)</span>
    <span class='self self kw'>self</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Delete a target.</span>
  <span class='comment val'>#    def delete_target( target )</span>
  <span class='comment val'>#      return unless @targets.include?( target )</span>
  <span class='comment val'>#      return unless deleted = @targets.delete( target )</span>
  <span class='comment val'>#      target.source = nil</span>
  <span class='comment val'>#    end</span>
  <span class='define_method identifier id'>define_method</span><span class='lparen token'>(</span> <span class='dstring node'>&quot;delete_#{name}&quot;</span> <span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='object identifier id'>object</span><span class='comma token'>,</span><span class='bitor op'>|</span>
    <span class='repository identifier id'>repository</span> <span class='assign token'>=</span> <span class='repository identifier id'>repository</span><span class='lparen token'>(</span> <span class='target identifier id'>target</span><span class='comma token'>,</span> <span class='type identifier id'>type</span> <span class='rparen token'>)</span>
    <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='deleted identifier id'>deleted</span> <span class='assign token'>=</span> <span class='repository identifier id'>repository</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span> <span class='object identifier id'>object</span> <span class='rparen token'>)</span>
    <span class='object identifier id'>object</span><span class='dot token'>.</span><span class='send identifier id'>send</span><span class='lparen token'>(</span> <span class='dstring node'>&quot;#{update}=&quot;</span><span class='comma token'>,</span> <span class='nil nil kw'>nil</span> <span class='rparen token'>)</span>
    <span class='deleted identifier id'>deleted</span>
  <span class='end end kw'>end</span>                                          

  <span class='comment val'># Return the number of targets a source has.</span>
  <span class='comment val'>#    def number_of_targets</span>
  <span class='comment val'>#      @targets.length</span>
  <span class='comment val'>#    end</span>
  <span class='define_method identifier id'>define_method</span><span class='lparen token'>(</span> <span class='dstring node'>&quot;number_of_#{target}&quot;</span> <span class='rparen token'>)</span> <span class='do do kw'>do</span>
    <span class='repository identifier id'>repository</span><span class='lparen token'>(</span> <span class='target identifier id'>target</span><span class='comma token'>,</span> <span class='type identifier id'>type</span> <span class='rparen token'>)</span><span class='dot token'>.</span><span class='length identifier id'>length</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Return true if the source has the given target.</span>
  <span class='comment val'>#    def has_target?( target )</span>
  <span class='comment val'>#      @targets.include?( target )</span>
  <span class='comment val'>#    end</span>
  <span class='define_method identifier id'>define_method</span><span class='lparen token'>(</span> <span class='dstring node'>&quot;has_#{name}?&quot;</span> <span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='object identifier id'>object</span><span class='comma token'>,</span><span class='bitor op'>|</span>
    <span class='repository identifier id'>repository</span><span class='lparen token'>(</span> <span class='target identifier id'>target</span><span class='comma token'>,</span> <span class='type identifier id'>type</span> <span class='rparen token'>)</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span> <span class='object identifier id'>object</span> <span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Iterate over each target.</span>
  <span class='comment val'>#    def each( &amp;block )</span>
  <span class='comment val'>#      @targets.each( &amp;block )</span>
  <span class='comment val'>#    end</span>
  <span class='class_eval identifier id'>class_eval</span> <span class='string val'>&quot;            def each_\#{name}( &amp;block )\n              repository( \&quot;\#{target}\&quot;, \#{type} ).each( &amp;block )\n            end\n&quot;</span>

  <span class='if if kw'>if</span> <span class='type identifier id'>type</span> <span class='eq op'>==</span> <span class='HashRepository constant id'>HashRepository</span>
    <span class='define_method identifier id'>define_method</span><span class='lparen token'>(</span> <span class='dstring node'>&quot;get_#{name}_by_id&quot;</span> <span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='id identifier id'>id</span><span class='comma token'>,</span><span class='bitor op'>|</span>
      <span class='repository identifier id'>repository</span><span class='lparen token'>(</span> <span class='target identifier id'>target</span><span class='comma token'>,</span> <span class='type identifier id'>type</span> <span class='rparen token'>)</span><span class='lbrack token'>[</span> <span class='id identifier id'>id</span> <span class='rbrack token'>]</span>          
    <span class='end end kw'>end</span>                                        
  <span class='class_eval identifier id'>class_eval</span> <span class='string val'>&quot;            def each_\#{name}_with_id( &amp;block )\n              repository( \#{target }, \#{type } ).each_with_id( &amp;block )\n            end\n&quot;</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Sun Aug  7 15:32:03 2011 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.2 (ruby-1.8.7).
</div>

  </body>
</html>